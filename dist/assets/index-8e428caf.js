import{r as i,j as t}from"./index-aeda1e87.js";import"./FileSaver.min-b2a08254.js";import{a as se,C as ne}from"./axios-057734f1.js";import{F as I}from"./index-9f5a0d13.js";import{S as u}from"./index-c463ec7e.js";import{T as ae,a as oe}from"./index-e00a8a8b.js";import{B as N,E as ie}from"./EditOutlined-3f21ada2.js";import{L as le}from"./index-06592163.js";import{S as ce,n as J}from"./SyncOutlined-80c16cfc.js";import{m as M}from"./index-a00c1fcb.js";import{I as de,E as ue,a as pe}from"./Pagination-637f931d.js";import"./useFlexGapSupport-69780201.js";import"./PlusOutlined-74a5f9c7.js";import"./index-cd8267bc.js";import"./row-da0b9f45.js";import"./responsiveObserver-953ba023.js";import"./col-bebaa28a.js";import"./Sider-20598f97.js";import"./useNotification-4ae4ff01.js";async function H(p,k){try{p=p.toLowerCase();let x=`https://api.lineascan.build/api?module=account&action=txlist&address=${p}&startblock=1&endblock=99999999&sort=asc&apikey=${k}`,d=(await se.get(x)).data.result;if(d.length===0)return"No transactions";d=d==null?void 0:d.filter(h=>h.from===p);let m=d==null?void 0:d.map(h=>h.to);m=m==null?void 0:m.map(h=>h.toLowerCase());let j=d==null?void 0:d.map(h=>h.timeStamp*1e3);return[m,j]}catch(x){return console.error(x),"Error"}}const{Content:he}=le;function De(){i.useState(0),i.useState(0),i.useState(!1),i.useState({});const[p,k]=i.useState([]);i.useState(!1),i.useState(!1),I.useForm(),I.useForm();const[x,b]=i.useState([]);I.useForm(),i.useState(!1);const[d,m]=i.useState(!1),[j,h]=i.useState(!1),[S,_]=i.useState(new Map),[$,z]=i.useState([]),[R,Q]=i.useState(!1),[V,X]=i.useState(0),[C,Z]=i.useState(!1),[v,q]=i.useState(localStorage.getItem("linea_api_key")),P="0x272e156df8da513c69cb41cc7a99185d53f926bb",F="0x009a0b7c38b542208936f1179151cd08e2943833",L="0x80e38291e06339d10aab483c65695d004dbd5c69",D="0x032b241De86a8660f1Ae0691a4760B426EA246d7",T="0xc66149996d0263C0B42D3bC05e50Db88658106cE",B="0xd3Ea3BC1F5A3F881bD6cE9761cbA5A0833a5d737",O="0x6131B5fae19EA4f9D964eAc0408E4408b66337b5",A="0x1d0188c4B276A09366D05d6Be06aF61a73bC7535",K="0xAd7f33984bed10518012013D4aB0458D37FEE6F3";i.useEffect(()=>{const e=localStorage.getItem("linea_api_key");e&&q(e)},[]);const G=()=>{Z(!C)},U=()=>C?t.jsx(ue,{}):t.jsx(pe,{}),W=async()=>{try{const e=[...p],r=[];for(let s of e)r.push(()=>new Promise(a=>{const n=f(s.address,P);s.horizon=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,F);s.bank=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,L);s.sync=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,D);s.izi=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,T);s.echo=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,B);s.leet=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,O);s.kyber=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,A);s.velo=n,a()})),r.push(()=>new Promise(a=>{const n=f(s.address,K);s.memdi=n,a()}));await Promise.all(r.map(s=>s())),z([...e]),localStorage.setItem("linea_addresses",JSON.stringify(e))}catch(e){console.error(e)}finally{m(!1)}},Y=async()=>{if(!x.length){J.error({message:"错误",description:"请先选择要刷新的地址"},2);return}m(!0);try{const e=[...p],r=[];for(let s of x){const a=e.findIndex(n=>n.key===s);if(a!==-1){const n=e[a],g=new Map,c=(await H(n.address,v))[0];g.set(n.address,c),_(g),await new Promise(l=>{setTimeout(()=>{l()},200)}),r.push(()=>new Promise(l=>{const o=y(c,P);n.horizon=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,F);n.bank=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,L);n.sync=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,D);n.izi=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,T);n.echo=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,B);n.leet=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,O);n.kyber=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,A);n.velo=o,l()})),r.push(()=>new Promise(l=>{const o=y(c,K);n.memdi=o,l()}))}}await Promise.all(r.map(s=>s())),z([...e]),localStorage.setItem("linea_addresses",JSON.stringify(e)),M.success("刷新成功")}catch(e){J.error({message:"错误",description:e.message},2)}finally{m(!1),b([])}},f=(e,r)=>{r=r.toLowerCase();const s=S.get(e);return s==null?(M.info("等待数据加载完成再刷新"),"error"):s==null?void 0:s.reduce((n,g)=>g===r?n+1:n,0)},y=(e,r)=>(r=r.toLowerCase(),e==null?void 0:e.reduce((a,n)=>n===r?a+1:a,0));i.useEffect(()=>{const e=()=>{X(window.innerHeight-180)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),i.useEffect(()=>{h(!0);const e=localStorage.getItem("linea_addresses");e&&(k(JSON.parse(e)),z(JSON.parse(e))),(async()=>{const s=JSON.parse(e);if(!s)return;const a=new Map;let n=[];const g=[];for(const w of s){const c=w.address,l=H(c,v).then(o=>{a.set(c,o[0]),n.push(o[1])}).catch(o=>{console.error(`Error fetching tasks for address ${c}:`,o)});g.push(l)}try{await Promise.all(g),h(!1),_(a);const w=n.flat();localStorage.setItem("linea_timestamps",JSON.stringify(w))}catch(w){console.error("Error fetching task contracts:",w)}})()},[]),i.useEffect(()=>{!R&&p.length>0&&S.size>0&&(W(),Q(!0))},[p,S]);const ee={selectedRowKeys:x,onChange:e=>{b(e)}},[re,E]=i.useState(null),te=[{title:"#",key:"index",align:"center",render:(e,r,s)=>s+1,width:34.5},{title:"备注",dataIndex:"name",key:"name",align:"center",render:(e,r)=>r.key===re?t.jsx(de,{placeholder:"请输入备注",defaultValue:e,onPressEnter:a=>{r.name=a.target.value,k([...p]),localStorage.setItem("linea_addresses",JSON.stringify(p)),E(null)}}):t.jsxs(t.Fragment,{children:[t.jsx(oe,{color:"blue",onClick:()=>E(r.key),children:e}),!e&&t.jsx(N,{shape:"circle",icon:t.jsx(ie,{}),size:"small",onClick:()=>E(r.key)})]}),width:70},{title:t.jsxs("span",{children:["钱包地址",t.jsx("span",{onClick:G,style:{marginLeft:8,cursor:"pointer"},children:U()})]}),dataIndex:"address",key:"address",align:"center",render:e=>C?"***":e,width:200},{title:"最后交易",dataIndex:"linea_last_tx",key:"linea_last_tx",align:"center",render:(e,r)=>{let s="inherit";return e===null?t.jsx(u,{}):(e!=null&&e.includes("天")&&parseInt(e)>7?s="red":s="#1677ff",t.jsx("a",{href:"https://lineascan.build/address/"+r.address,target:"_blank",style:{color:s},children:e}))},width:65},{title:t.jsxs("a",{href:"https://defillama.com/chain/linea",style:{color:"white"},target:"_blank",rel:"noopener noreferrer",children:["Linea Task List  [参考defillama TVL数据] ",t.jsx("br",{}),"🔴请注意，通过点击任务列表的超链接，您将离开本网页。我们建议您在访问这些外部链接之前，仔细阅读其网站的隐私政策和使用条款。我们不能控制这些网站的内容和安全性，并且不对其造成的任何损失或损害负责。 在访问外部链接时，您需要自行评估潜在的风险。这些链接不构成对所链接网站内容的认可或支持。我们不对这些外部链接的准确性、内容、服务质量或安全性做任何承诺。 我们建议您保持您的计算机和设备的安全性，使用防病毒软件和防火墙，并时刻注意潜在的网络钓鱼或恶意软件攻击。 通过继续使用本网页并访问其中的超链接，您同意承担访问外部链接可能带来的一切风险。我们不对由此导致的任何损失或损害负责！"]}),key:"zks_era_group",className:"zks_era",children:[{title:t.jsx("a",{href:"https://kyberswap.com/swap/linea",target:"_blank",rel:"noopener noreferrer",children:"KyberSwap"}),dataIndex:"kyber",key:"kyber",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.kyber===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://linea.velocore.xyz/swap",target:"_blank",rel:"noopener noreferrer",children:"velo"}),dataIndex:"velo",key:"velo",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.velo===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://mendi.finance/",target:"_blank",rel:"noopener noreferrer",children:"Memdi"}),dataIndex:"memdi",key:"memdi",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.memdi===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://app.horizondex.io/swap",target:"_blank",rel:"noopener noreferrer",children:"horizondex"}),dataIndex:"horizon",key:"horizon",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.horizon===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://lineabank.finance/bank",target:"_blank",rel:"noopener noreferrer",children:"LineaBank"}),dataIndex:"bank",key:"bank",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.bank===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://syncswap.xyz/",target:"_blank",rel:"noopener noreferrer",children:"syncSwap"}),dataIndex:"sync",key:"sync",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.sync===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://izumi.finance/trade/swap",target:"_blank",rel:"noopener noreferrer",children:"iZiSwap"}),dataIndex:"izi",key:"izi",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.izi===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://www.echodex.io/swap",target:"_blank",rel:"noopener noreferrer",children:"EchoDEX"}),dataIndex:"echo",key:"echo",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.echo===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:t.jsx("a",{href:"https://linea.leetswap.finance/#/swap",target:"_blank",rel:"noopener noreferrer",children:"leetSwap"}),dataIndex:"leet",key:"leet",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.leet===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(u,{}):e}),width:65},{title:"进度",dataIndex:"progress",key:"progress",align:"center",sorter:(e,r)=>e.progress-r.progress,render:(e,r)=>{const s=["horizon","bank","sync","izi","echo","leet","kyber","velo","memdi"],n=s.reduce((w,c)=>r[c]>0?w+1:w,0)/s.length*100;r.progress=n;const g=`rgba(240, 121, 78, ${n/100})`;return{children:t.jsx("span",{children:e===null?t.jsx(u,{}):`${n.toFixed(2)}%`}),props:{style:{background:g}}}},width:65}]}];return t.jsx("div",{children:t.jsx(he,{children:t.jsx(u,{spinning:j,children:t.jsx(ae,{rowSelection:ee,dataSource:$,pagination:!1,bordered:!0,style:{marginBottom:"0px",zIndex:2},size:"small",columns:te,scroll:{y:V},footer:()=>t.jsx(ne,{children:t.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",gap:"10px"},children:t.jsx(N,{type:"primary",onClick:Y,loading:d,size:"large",style:{width:"20%"},icon:t.jsx(ce,{}),children:d?"正在刷新":"刷新选中地址"})})})})})})})}export{De as default};
