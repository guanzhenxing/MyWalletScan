import{r as l,j as r}from"./index-aeda1e87.js";import"./FileSaver.min-b2a08254.js";import{a as K,C as se}from"./axios-057734f1.js";import{S as m}from"./index-c463ec7e.js";import{T as ne,a as ae}from"./index-e00a8a8b.js";import{B as J,E as oe}from"./EditOutlined-3f21ada2.js";import{L as ie}from"./index-06592163.js";import{S as de,n as U}from"./SyncOutlined-80c16cfc.js";import{m as $}from"./index-a00c1fcb.js";import{I as le,E as ce,a as pe}from"./Pagination-637f931d.js";import"./useFlexGapSupport-69780201.js";import"./PlusOutlined-74a5f9c7.js";import"./Sider-20598f97.js";import"./index-cd8267bc.js";import"./useNotification-4ae4ff01.js";import"./responsiveObserver-953ba023.js";async function M(g){try{let w=`https://voyager.online/api/contract/${g}/transfers?ps=50&p=1`;const k=await K.get(w);let f=k.data.items.map(u=>u.transfer_to);const x=k.data.lastPage;if(x>1)for(let u=2;u<=x;u++){const j=`https://voyager.online/api/contract/${g}/transfers?ps=50&p=${u}`;let y=(await K.get(j)).data.items.map(b=>b.transfer_to);f=f.concat(y)}return f=f.map(u=>u.toLowerCase()),f=[...new Set(f)],f}catch(w){return console.error(w),"Error"}}const{Content:ue}=ie;function Ce(){const[g,w]=l.useState([]),[k,f]=l.useState([]),[x,u]=l.useState(!1),[j,S]=l.useState(!1),[y,b]=l.useState(new Map),[B,_]=l.useState([]),[R,V]=l.useState(!1),[Q,q]=l.useState(0),[v,G]=l.useState(!1),I="0x04d0390b777b424e43839cd1e744799f3de6c176c7e32c1812a41dbd9c19db6a",T="0x045e7131d776dddc137e30bdd490b431c7144677e97bf9369f629ed8d3fb7dd6",C="0x07e2a13b40fc1119ec55e0bcf9428eedaa581ab3c924561ad4e955f95da63138",z="0x010884171baf1914edc28d7afb619b40a4051cfae78a094a55d230f19e944a28",D="0x04270219d365d6b017231b52e92b3fb5d7c8378b05e9abc97724537a80e93b0f",P="0x04c0a5193d58f74fbace4b74dcf65481e734ed1714121bdc571da345540efa05",L="0x05900cfa2b50d53b097cb305d54e249e31f24f881885aae5639b0cd6af4ed298",H="0x000023c72abdf49dffc85ae3ede714f2168ad384cc67d08524732acea90df325",N="0x017e9e62c04b50800d7c59454754fe31a2193c9c3c6c92c093f2ab0faadf8c87",A="0x030615bec9c1506bfac97d9dbd3c546307987d467a7f95d5533c2e861eb81f3f",O="0x00691fa7f66d63dc8c89ff4e77732fff5133f282e7dbd41813273692cc595516",F="0x0032ebb8e68553620b97b308684babf606d9556d5c0a652450c32e85f40d000d",W=()=>{G(!v)},X=()=>v?r.jsx(ce,{}):r.jsx(pe,{}),Y=async()=>{try{const e=[...g],t=[];for(let s of e)t.push(()=>new Promise(a=>{const n=(c(s.address,T)||c(s.address,I||c(s.address,C)))>0?"✅":"❌";s.jedi=n,a()})),t.push(()=>new Promise(a=>{const n=c(s.address,z)>0?"✅":"❌";s.myswap=n,a()})),t.push(()=>new Promise(a=>{const n=c(s.address,D)>0?"✅":"❌";s.avnu=n,a()})),t.push(()=>new Promise(a=>{const n=c(s.address,P)>0?"✅":"❌";s.zklend=n,a()})),t.push(()=>new Promise(a=>{const n=(c(s.address,H)||c(s.address,L)||c(s.address,N))>0?"✅":"❌";s._10k=n,a()})),t.push(()=>new Promise(a=>{const n=(c(s.address,F)||c(s.address,A)||c(s.address,O))>0?"✅":"❌";s.sith=n,a()}));await Promise.all(t.map(s=>s())),_([...e]),localStorage.setItem("stark_addresses",JSON.stringify(e))}catch(e){console.error(e)}finally{u(!1)}},Z=async()=>{if(!k.length){U.error({message:"错误",description:"请先选择要刷新的地址"},2);return}u(!0);try{const e=[...g],t=[];for(let s of k){const a=e.findIndex(n=>n.key===s);if(a!==-1){const n=e[a],h=new Map,o=await M(n.address);h.set(n.address,o),b(h),await new Promise(i=>{setTimeout(()=>{i()},200)}),t.push(()=>new Promise(i=>{const d=(p(o,I)||p(o,T)||p(o,C))>0?"✅":"❌";n.jedi=d,i()})),t.push(()=>new Promise(i=>{const d=p(o,z)>0?"✅":"❌";n.myswap=d,i()})),t.push(()=>new Promise(i=>{const d=p(o,D)>0?"✅":"❌";n.avnu=d,i()})),t.push(()=>new Promise(i=>{const d=p(o,P)>0?"✅":"❌";n.zklend=d,i()})),t.push(()=>new Promise(i=>{const d=(p(o,H)||p(o,L)||p(o,N))>0?"✅":"❌";n._10k=d,i()})),t.push(()=>new Promise(i=>{const d=(p(o,F)||p(o,A)||p(o,O))>0?"✅":"❌";n.sith=d,i()}))}}await Promise.all(t.map(s=>s())),_([...e]),localStorage.setItem("stark_addresses",JSON.stringify(e)),$.success("刷新成功")}catch(e){U.error({message:"错误",description:e.message},2)}finally{u(!1),f([])}},c=(e,t)=>{t=t.toLowerCase();const s=y.get(e);return s==null?($.info("等待数据加载完成再刷新"),"error"):s.reduce((n,h)=>h===t?n+1:n,0)},p=(e,t)=>(t=t.toLowerCase(),e.reduce((a,n)=>n===t?a+1:a,0));l.useEffect(()=>{const e=()=>{q(window.innerHeight-180)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),l.useEffect(()=>{S(!0);const e=localStorage.getItem("stark_addresses");e&&(w(JSON.parse(e)),_(JSON.parse(e))),(async()=>{const s=JSON.parse(e);if(!s)return;const a=new Map,n=[];for(const h of s){const o=h.address,i=M(o).then(d=>{a.set(o,d)}).catch(d=>{console.error(`Error fetching tasks for address ${o}:`,d)});n.push(i)}try{await Promise.all(n),S(!1),b(a)}catch(h){console.error("Error fetching task contracts:",h)}})()},[]),l.useEffect(()=>{!R&&g.length>0&&y.size>0&&(Y(),V(!0))},[g,y]);const ee={selectedRowKeys:k,onChange:e=>{f(e)}},[te,E]=l.useState(null),re=[{title:"#",key:"index",align:"center",render:(e,t,s)=>s+1,width:34.5},{title:"备注",dataIndex:"name",key:"name",align:"center",render:(e,t)=>t.key===te?r.jsx(le,{placeholder:"请输入备注",defaultValue:e,onPressEnter:a=>{t.name=a.target.value,w([...g]),localStorage.setItem("stark_addresses",JSON.stringify(g)),E(null)}}):r.jsxs(r.Fragment,{children:[r.jsx(ae,{color:"blue",onClick:()=>E(t.key),children:e}),!e&&r.jsx(J,{shape:"circle",icon:r.jsx(oe,{}),size:"small",onClick:()=>E(t.key)})]}),width:70},{title:r.jsxs("span",{children:["钱包地址",r.jsx("span",{onClick:W,style:{marginLeft:8,cursor:"pointer"},children:X()})]}),dataIndex:"address",key:"address",align:"center",className:"address",render:(e,t)=>v?"***":e===null?r.jsx(m,{}):e,width:200},{title:"最后交易",dataIndex:"stark_latest_tx_time",key:"stark_latest_tx_time",align:"center",render:(e,t)=>{let s="inherit";return e===null?r.jsx(m,{}):(e!=null&&e.includes("天")&&parseInt(e)>7?s="red":s="#1677ff",r.jsx("a",{href:"https://starkscan.co/contract/"+t.address,target:"_blank",style:{color:s},children:e}))},width:60},{title:r.jsxs("a",{href:"https://defillama.com/chain/Starknet",style:{color:"white"},target:"_blank",rel:"noopener noreferrer",children:["StarkNet Task List  [参考defillama TVL数据] 🟡部分Dex只统计eth/usdc eth/usdt eth/dai交易记录",r.jsx("br",{}),"🔴请注意，通过点击任务列表的超链接，您将离开本网页。我们建议您在访问这些外部链接之前，仔细阅读其网站的隐私政策和使用条款。我们不能控制这些网站的内容和安全性，并且不对其造成的任何损失或损害负责。 在访问外部链接时，您需要自行评估潜在的风险。这些链接不构成对所链接网站内容的认可或支持。我们不对这些外部链接的准确性、内容、服务质量或安全性做任何承诺。 我们建议您保持您的计算机和设备的安全性，使用防病毒软件和防火墙，并时刻注意潜在的网络钓鱼或恶意软件攻击。 通过继续使用本网页并访问其中的超链接，您同意承担访问外部链接可能带来的一切风险。我们不对由此导致的任何损失或损害负责！"]}),key:"starkNet_group",className:"starkNet",children:[{title:r.jsx("a",{href:"https://app.jediswap.xyz/#/swap",target:"_blank",rel:"noopener noreferrer",children:"JediSwap"}),dataIndex:"jedi",key:"jedi",align:"center",filters:[{text:"未完成",value:"❌"},{text:"已完成",value:"✅"}],onFilter:(e,t)=>t.jedi===e,render:(e,t)=>r.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?r.jsx(m,{}):e}),width:60},{title:r.jsx("a",{href:"https://www.myswap.xyz/",target:"_blank",rel:"noopener noreferrer",children:"mySwap"}),dataIndex:"myswap",key:"myswap",align:"center",filters:[{text:"未完成",value:"❌"},{text:"已完成",value:"✅"}],onFilter:(e,t)=>t.myswap===e,render:(e,t)=>r.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?r.jsx(m,{}):e}),width:60},{title:r.jsx("a",{href:"https://10kswap.com/swap",target:"_blank",rel:"noopener noreferrer",children:"10KSwap"}),dataIndex:"_10k",key:"_10k",align:"center",filters:[{text:"未完成",value:"❌"},{text:"已完成",value:"✅"}],onFilter:(e,t)=>t._10k===e,render:(e,t)=>r.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?r.jsx(m,{}):e}),width:60},{title:r.jsx("a",{href:"https://app.avnu.fi/en",target:"_blank",rel:"noopener noreferrer",children:"AVNU"}),dataIndex:"avnu",key:"avnu",align:"center",filters:[{text:"未完成",value:"❌"},{text:"已完成",value:"✅"}],onFilter:(e,t)=>t.avnu===e,render:(e,t)=>r.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?r.jsx(m,{}):e}),width:60},{title:r.jsx("a",{href:"https://app.zklend.com/markets",target:"_blank",rel:"noopener noreferrer",children:"zkLend"}),dataIndex:"zklend",key:"zklend",align:"center",filters:[{text:"未完成",value:"❌"},{text:"已完成",value:"✅"}],onFilter:(e,t)=>t.zklend===e,render:(e,t)=>r.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?r.jsx(m,{}):e}),width:60},{title:r.jsx("a",{href:"https://app.sithswap.com/swap/",target:"_blank",rel:"noopener noreferrer",children:"SithSwap"}),dataIndex:"sith",key:"sith",align:"center",filters:[{text:"未完成",value:"❌"},{text:"已完成",value:"✅"}],onFilter:(e,t)=>t.sith===e,render:(e,t)=>r.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?r.jsx(m,{}):e}),width:60},{title:"NFT",children:[{title:r.jsx("a",{href:"https://mail.dmail.ai/presale/394965",target:"_blank",rel:"noopener noreferrer",children:"Dmail"}),align:"center",render:()=>"/",width:60},{title:r.jsx("a",{href:"https://app.starknet.id/identities",target:"_blank",rel:"noopener noreferrer",children:"StarknetId"}),align:"center",render:()=>"/",width:60},{title:r.jsx("a",{href:"https://starkverse.art/",target:"_blank",rel:"noopener noreferrer",children:"starkverse"}),align:"center",render:()=>"/",width:60}]},{title:"进度",dataIndex:"progress",key:"progress",align:"center",sorter:(e,t)=>e.progress-t.progress,render:(e,t)=>{const s=["jedi","myswap","avnu","zklend","_10k","sith"],n=s.reduce((o,i)=>t[i]==="✅"?o+1:o,0)/s.length*100;t.progress=n;const h=`rgba(240, 121, 78, ${n/100})`;return{children:r.jsx("span",{children:e===null?r.jsx(m,{}):`${n.toFixed(2)}%`}),props:{style:{background:h}}}},width:60}]}];return r.jsx("div",{children:r.jsx(ue,{children:r.jsx(m,{spinning:j,children:r.jsx(ne,{rowSelection:ee,dataSource:B,pagination:!1,bordered:!0,style:{marginBottom:"0px",zIndex:2},size:"small",columns:re,scroll:{y:Q},footer:()=>r.jsx(se,{children:r.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",gap:"10px"},children:r.jsx(J,{type:"primary",onClick:Z,loading:x,size:"large",style:{width:"20%"},icon:r.jsx(de,{}),children:x?"正在刷新":"刷新选中地址"})})})})})})})}export{Ce as default};
