import{r as _,j as t}from"./index-aeda1e87.js";import{C as R,D as je,E as re,F as se}from"./getScore-3c6d58b9.js";import{U as Ce,D as Fe,e as Ee}from"./save_excel-2f1f7d40.js";import{a as B,C as Ie}from"./axios-057734f1.js";import{F as J}from"./index-9f5a0d13.js";import{M as De,P as oe,D as ae}from"./DeleteOutlined-67da6863.js";import{S}from"./index-c463ec7e.js";import{T as f,a as Ne}from"./index-e00a8a8b.js";import{B as z,E as Oe}from"./EditOutlined-3f21ada2.js";import{L as Ue}from"./index-06592163.js";import{I as he,E as Le,a as Me}from"./Pagination-637f931d.js";import{S as Be,n as H}from"./SyncOutlined-80c16cfc.js";import{m as ce}from"./index-a00c1fcb.js";import{S as ze}from"./index-cd8267bc.js";import"./useFlexGapSupport-69780201.js";import"./FileSaver.min-b2a08254.js";import"./PlusOutlined-74a5f9c7.js";import"./row-da0b9f45.js";import"./responsiveObserver-953ba023.js";import"./col-bebaa28a.js";import"./index-d904ea6a.js";import"./Sider-20598f97.js";import"./useNotification-4ae4ff01.js";async function ie(r){try{let d=`https://blockscout.scroll.io/api?module=account&action=balance&address=${r}`;const w=await B.get(d);return{balance:parseFloat(R(w.data.result)).toFixed(4)}}catch(d){return console.error(d),{balance:"Error"}}}function $e(r){return`${r.getUTCFullYear()}-${r.getUTCMonth()+1}-${r.getUTCDate()}`}function Pe(r){r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),r.setUTCDate(r.getUTCDate()+4-(r.getUTCDay()||7));let d=new Date(Date.UTC(r.getUTCFullYear(),0,1)),w=Math.ceil(((r-d)/864e5+1)/7);return r.getUTCFullYear()+"W"+w}function Ve(r){return r.getUTCFullYear()+"-"+(r.getUTCMonth()+1)}function Je(r){const d=new Date(r),w=8,k=new Date(d.getTime()+w*3600*1e3),A=new Date,i=new Date(A.getTime()+w*3600*1e3)-k,u=Math.floor(i/(1e3*60*60)),j=Math.floor(u/24);return j>0?`${j} 天前`:u>0?`${u} 小时前`:"刚刚"}const He=async()=>{try{const r={method:"GET",url:"https://min-api.cryptocompare.com/data/price?fsym=ETH&tsyms=USD"};return(await B.request(r)).data.USD}catch(r){return console.log(r),"/"}};async function de(r){try{let d=new Set,w=new Set,k=new Set;r=r.toLowerCase();let A=`https://blockscout.scroll.io/api?module=account&action=txlist&address=${r}&startblock=0&endblock=9999999999&page=1&offset=9999&sort=asc`,i=(await B.get(A)).data.result;i=i.filter(T=>T.from===r);let u=i.map(T=>T.to);u=[...new Set(u)];let j=i.map(T=>new Date(T.timeStamp*1e3));const D=j[j.length-1];j.forEach(T=>{d.add($e(T)),w.add(Pe(T)),k.add(Ve(T))});let C=0n;i.forEach(T=>{const P=BigInt(T.gasPrice),G=BigInt(T.gasUsed),X=P*G;C+=X});const F=R(C),N=i.reduce((T,P)=>T+parseFloat(R(P.value)),0),y=await He(),O=N*y,Y=i.length,K=Je(D),$=d.size,Q=w.size,W=k.size,q=u.length;return{scroll_tx_amount:Y,scroll_last_tx:K,dayActivity:$,weekActivity:Q,monthActivity:W,contractActivity:q,totalFee:parseFloat(F).toFixed(4),totalExchangeAmount:parseFloat(O).toFixed(2)}}catch(d){return console.error(d),{scroll_tx_amount:"Error",scroll_last_tx:"Error",dayActivity:"Error",weekActivity:"Error",monthActivity:"Error",contractActivity:"Error",totalFee:"Error",totalExchangeAmount:"Error"}}}async function ue(r){var d,w;try{let k=6,A=`https://blockscout.scroll.io/api?module=account&action=tokenbalance&contractaddress=0xf55bec9cafdbe8730f096aa55dad6d22d44099df&address=${r}`;const I=await B.get(A),i=parseFloat(((d=I.data)==null?void 0:d.result)/Math.pow(10,k)).toFixed(2);let u=`https://blockscout.scroll.io/api?module=account&action=tokenbalance&contractaddress=0x06eFdBFf2a14a7c8E15944D1F4A48F9F95F663A4&address=${r}`;const j=await B.get(u),D=parseFloat(((w=j.data)==null?void 0:w.result)/Math.pow(10,k)).toFixed(2);return{USDT:i,USDC:D}}catch(k){return console.error(k),{USDT:"Error",USDC:"Error"}}}async function me(r){try{r=r.toLowerCase();let d=`https://blockscout.scroll.io/api?module=account&action=txlistinternal&address=${r}&startblock=0&endblock=9999999999&page=1&offset=9999&sort=asc`;const A=(await B.get(d)).data.result.filter(y=>y.from==="0x6ea73e05adc79974b931123675ea8f78ffdacdf0"&&y.to===r&&(y==null?void 0:y.value)>1),I=A==null?void 0:A.length,i=A.reduce((y,O)=>y+parseFloat(R(O.value)),0).toFixed(3);let u=`https://blockscout.scroll.io/api?module=account&action=txlist&address=${r}&startblock=0&endblock=9999999999&page=1&offset=9999&sort=asc`;const C=(await B.get(u)).data.result.filter(y=>y.from===r&&y.to==="0x4c0926ff5252a435fd19e10ed15e5a249ba19d79"&&(y==null?void 0:y.value)>1),F=C==null?void 0:C.length,N=C.reduce((y,O)=>y+parseFloat(R(O.value)),0).toFixed(3);return{l1Tol2Times:I,l1Tol2Amount:i,l2Tol1Times:F,l2Tol1Amount:N}}catch(d){return console.error(d),{l1Tol2Times:"Error",l1Tol2Amount:"Error",l2Tol1Times:"Error",l2Tol1Amount:"Error"}}}const{Content:Re}=Ue,{TextArea:Ke}=he;function xt(){const[r,d]=_.useState(0),[w,k]=_.useState(0),[A,I]=_.useState(!1),[i,u]=_.useState([]),[j,D]=_.useState(!1),[C]=J.useForm(),[F,N]=_.useState([]);J.useForm(),_.useState(!1);const[y,O]=_.useState(!1),[Y,K]=_.useState(!1),[$,Q]=_.useState(!1),[W,q]=_.useState([]),[T,P]=_.useState(0);J.useForm(),_.useState(!1);const G=()=>{Q(!$)},X=()=>$?t.jsx(Le,{}):t.jsx(Me,{});_.useEffect(()=>{const e=()=>{P(window.innerHeight-210)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]);const ye=async()=>{if(!F.length){H.error({message:"错误",description:"请先选择要刷新的地址"},2);return}O(!0);try{let l=0,a=[];const s=[...i],b=()=>{for(;l<2&&a.length>0;){const g=a.shift();l+=1,g().finally(()=>{l-=1,b()})}a.length>0&&setTimeout(b,2500)};for(let g of F){const p=s.findIndex(n=>n.key===g);if(p!==-1){const n=s[p];a.push(()=>(n.scroll_eth_balance=null,ie(n.address).then(({balance:c})=>{n.scroll_eth_balance=c,u([...s]),localStorage.setItem("scroll_addresses",JSON.stringify(s))}))),a.push(async()=>(n.scroll_usdt_balance=null,n.scroll_usdc_balance=null,ue(n.address).then(({USDT:c,USDC:x})=>{n.scroll_usdt_balance=c,n.scroll_usdc_balance=x,u([...s]),localStorage.setItem("scroll_addresses",JSON.stringify(s))}))),a.push(()=>(n.scroll_tx_amount=null,n.scroll_last_tx=null,n.dayActivity=null,n.weekActivity=null,n.monthActivity=null,n.contractActivity=null,n.totalFee=null,de(n.address).then(({scroll_tx_amount:c,scroll_last_tx:x,dayActivity:o,weekActivity:v,monthActivity:E,contractActivity:L,totalFee:m,totalExchangeAmount:h})=>{n.scroll_tx_amount=c,n.scroll_last_tx=x,n.dayActivity=o,n.weekActivity=v,n.monthActivity=E,n.contractActivity=L,n.totalFee=m,n.totalExchangeAmount=h,u([...s]),localStorage.setItem("scroll_addresses",JSON.stringify(s))}))),a.push(()=>(n.eth_balance=null,re(n.address,"ethereum").then(c=>{n.eth_balance=c,u([...s]),localStorage.setItem("scroll_addresses",JSON.stringify(s))}))),a.push(()=>(n.eth_tx_amount=null,se(n.address,"ethereum").then(c=>{n.eth_tx_amount=c,u([...s]),localStorage.setItem("scroll_addresses",JSON.stringify(s))}))),a.push(()=>(n.l1Tol2Times=null,n.l1Tol2Amount=null,n.l2Tol1Times=null,n.l2Tol1Amount=null,me(n.address).then(({l1Tol2Times:c,l1Tol2Amount:x,l2Tol1Times:o,l2Tol1Amount:v})=>{n.l1Tol2Times=c,n.l1Tol2Amount=x,n.l2Tol1Times=o,n.l2Tol1Amount=v,u([...s]),localStorage.setItem("scroll_addresses",JSON.stringify(s))})))}}b()}catch(e){H.error({message:"错误",description:e.message},2)}finally{O(!1),N([]),ce.success("刷新成功")}},ge=async()=>{try{I(!0),D(!1);const a=(await C.validateFields()).addresses.split(`
`).map(o=>{const[v,E]=o.split(",");return{address:v.trim(),name:E?E.trim():""}}),s=a.map(o=>o.address),b=a.map(o=>o.name);k(s.length);const g=[...i],p=3;let n=0,c=[];d(0);const x=()=>{for(;c.length>0&&n<p;){const o=c.shift();n+=1,o().finally(()=>{n-=1,x()})}};for(let o of s){o=o.trim();let v=b[s.indexOf(o)];if(o.length!==42){H.error({message:"错误",description:"请输入正确的地址"});continue}let E=()=>new Promise((h,U)=>{d(M=>M+1),h()});const L=g.findIndex(h=>h.address===o),m=L!==-1?g[L]:{key:g.length.toString(),address:o,name:v,eth_balance:null,eth_tx_amount:null,scroll_eth_balance:null,scroll_last_tx:null,scroll_tx_amount:null,scroll_usdt_balance:null,scroll_usdc_balance:null,scroll_usdtBalance:null,dayActivity:null,weekActivity:null,monthActivity:null,l1Tol2Times:null,l1Tol2Amount:null,l2Tol1Times:null,l2Tol1Amount:null,contractActivity:null,totalFee:null,totalExchangeAmount:null};L===-1&&g.push(m),c.push(()=>ie(o).then(({balance:h})=>{m.scroll_eth_balance=h})),c.push(()=>ue(o).then(({USDT:h,USDC:U})=>{m.scroll_usdt_balance=h,m.scroll_usdc_balance=U})),c.push(()=>re(o,"ethereum").then(h=>{m.eth_balance=h})),c.push(()=>se(o,"ethereum").then(h=>{m.eth_tx_amount=h})),c.push(()=>de(o).then(({scroll_tx_amount:h,scroll_last_tx:U,dayActivity:M,weekActivity:V,monthActivity:ee,contractActivity:te,totalFee:le,totalExchangeAmount:ne})=>{m.scroll_tx_amount=h,m.scroll_last_tx=U,m.dayActivity=M,m.weekActivity=V,m.monthActivity=ee,m.contractActivity=te,m.totalFee=le,m.totalExchangeAmount=ne})),c.push(()=>me(o).then(({l1Tol2Times:h,l1Tol2Amount:U,l2Tol1Times:M,l2Tol1Amount:V})=>{m.l1Tol2Times=h,m.l1Tol2Amount=U,m.l2Tol1Times=M,m.l2Tol1Amount=V})),c.push(E),x()}for(;n>0||c.length>0;)await new Promise(o=>setTimeout(o,1e3));u(g),localStorage.setItem("scroll_addresses",JSON.stringify(g))}catch(e){H.error({message:"错误",description:e.message})}finally{I(!1),d(0),C.resetFields(),N([]),ce.success("地址添加成功")}},xe=()=>{D(!0)},pe=()=>{Ee(i,"walletInfo")};_.useEffect(()=>{K(!0);const e=localStorage.getItem("scroll_addresses");setTimeout(()=>{K(!1)},500),e&&(u(JSON.parse(e)),q(JSON.parse(e)))},[]),_.useEffect(()=>{const e=[...i];for(const l of e)setTimeout(async()=>{const a=await je(l);l.scroll_score=a,e.every(b=>b.zk_score!==void 0)&&u(e)},0)},[W]);const fe=e=>{u(i.filter(l=>l.key!==e)),localStorage.setItem("scroll_addresses",JSON.stringify(i.filter(l=>l.key!==e)))},_e=()=>{if(!F.length){H.error({message:"错误",description:"请先选择要删除的地址"},2);return}u(i.filter(e=>!F.includes(e.key))),localStorage.setItem("scroll_addresses",JSON.stringify(i.filter(e=>!F.includes(e.key)))),N([])},Te={selectedRowKeys:F,onChange:e=>{N(e)}},be=()=>{D(!1)},[we,Z]=_.useState(null),Se=[{title:"#",key:"index",align:"center",render:(e,l,a)=>a+1,width:70},{title:"备注",dataIndex:"name",key:"name",align:"center",render:(e,l)=>l.key===we?t.jsx(he,{placeholder:"请输入备注",defaultValue:e,onPressEnter:s=>{l.name=s.target.value,u([...i]),localStorage.setItem("scroll_addresses",JSON.stringify(i)),Z(null)}}):t.jsxs(t.Fragment,{children:[t.jsx(Ne,{color:"blue",onClick:()=>Z(l.key),children:e}),!e&&t.jsx(z,{shape:"circle",icon:t.jsx(Oe,{}),size:"small",onClick:()=>Z(l.key)})]}),width:90},{title:t.jsxs("span",{children:["钱包地址",t.jsx("span",{onClick:G,style:{marginLeft:8,cursor:"pointer"},children:X()})]}),dataIndex:"address",key:"address",align:"center",render:(e,l)=>$?"***":e,width:360},{title:"ETH",key:"eth_group",className:"zks_eth",children:[{title:"ETH",dataIndex:"eth_balance",key:"eth_balance",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:80},{title:"Tx",dataIndex:"eth_tx_amount",key:"eth_tx_amount",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:80}]},{title:"Scroll Mainnet",key:"zks_era_group",className:"zks_era",children:[{title:"ETH",dataIndex:"scroll_eth_balance",key:"scroll_eth_balance",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:70},{title:"USDC",dataIndex:"scroll_usdc_balance",key:"scroll_usdc_balance",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:70},{title:"USDT",dataIndex:"scroll_usdt_balance",key:"scroll_usdt_balance",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:70},{title:"Tx",dataIndex:"scroll_tx_amount",key:"scroll_tx_amount",align:"center",sorter:(e,l)=>e.scroll_tx_amount-l.scroll_tx_amount,render:(e,l)=>{if(e===null)return t.jsx(S,{});const a=Math.log(e),s=Math.log(1),b=Math.log(100),g=(a-s)/(b-s),p=.1,x=`rgba(173, 216, 230, ${g*(1-p)+p})`;return{children:e,props:{style:{background:x}}}},width:50},{title:"最后交易",dataIndex:"scroll_last_tx",key:"scroll_last_tx",align:"center",render:(e,l)=>{let a="inherit";return e===null?t.jsx(S,{}):(e!=null&&e.includes("天")&&parseInt(e)>7?a="red":a="#1677ff",t.jsx("a",{href:"https://scrollscan.com/address/"+l.address,target:"_blank",style:{color:a},children:e}))},width:85},{title:"官方桥跨链Tx数",key:"cross_chain_tx_count_group",children:[{title:"L1->L2",dataIndex:"l1Tol2Times",key:"l1Tol2Times",align:"center",sorter:(e,l)=>e.l1Tol2Times-l.l1Tol2Times,render:(e,l)=>e===null?"/":e,width:75},{title:"L2->L1",dataIndex:"l2Tol1Times",key:"l2Tol1Times",align:"center",render:(e,l)=>e===null?"/":e,width:55}]},{title:"官方桥跨链金额",key:"cross_chain_amount_group",children:[{title:"L1->L2",dataIndex:"l1Tol2Amount",key:"l1Tol2Amount",align:"center",render:(e,l)=>e===null?"/":e,width:55},{title:"L2->L1",dataIndex:"l2Tol1Amount",key:"l2Tol1Amount",align:"center",render:(e,l)=>e===null?"/":e,width:55}]},{title:"活跃统计",key:"activity_stats_group",children:[{title:"日",dataIndex:"dayActivity",key:"dayActivity",align:"center",sorter:(e,l)=>e.dayActivity-l.dayActivity,render:(e,l)=>e===null?t.jsx(S,{}):e,width:55},{title:"周",dataIndex:"weekActivity",key:"weekActivity",align:"center",sorter:(e,l)=>e.weekActivity-l.weekActivity,render:(e,l)=>e===null?t.jsx(S,{}):e,width:50},{title:"月",dataIndex:"monthActivity",key:"monthActivity",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:50},{title:"不同合约",dataIndex:"contractActivity",key:"contractActivity",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:85},{title:"金额(U)",dataIndex:"totalExchangeAmount",key:"totalExchangeAmount",align:"center",sorter:(e,l)=>e.totalExchangeAmount-l.totalExchangeAmount,render:(e,l)=>{if(e===null)return"/";const a=Math.log(e),s=Math.log(1),b=Math.log(100),g=(a-s)/(b-s),p=.1,x=`rgba(211, 211, 211, ${g*(1-p)+p})`;return{children:e,props:{style:{background:x}}}},width:90},{title:"FeeΞ",dataIndex:"totalFee",key:"totalFee",align:"center",render:(e,l)=>e===null?t.jsx(S,{}):e,width:80}]}]},{title:"评分",dataIndex:"scroll_score",key:"scroll_score",align:"center",sorter:(e,l)=>e.scroll_score-l.scroll_score,render:(e,l)=>{if(e===null)return t.jsx(S,{});const a=Math.log(e),s=Math.log(1),b=Math.log(100),g=(a-s)/(b-s),p=.1,x=`rgba(240, 121, 78, ${g*(1-p)+p})`;return{children:e,props:{style:{background:x}}}},width:70},{title:"操作",key:"action",align:"center",render:(e,l)=>t.jsx(ze,{size:"small",children:t.jsx(oe,{title:"确认删除？",onConfirm:()=>fe(l.key),children:t.jsx(z,{icon:t.jsx(ae,{})})})}),width:70}];return t.jsx("div",{children:t.jsxs(Re,{children:[t.jsx(De,{title:"批量添加地址",open:j,onOk:ge,onCancel:be,okButtonProps:{loading:y},okText:"添加地址",cancelText:"取消",children:t.jsx(J,{form:C,layout:"vertical",children:t.jsx(J.Item,{label:"地址",name:"addresses",rules:[{required:!0}],children:t.jsx(Ke,{placeholder:"请输入地址，每行一个  要添加备注时放在地址后以逗号(,)间隔",style:{width:"500px",height:"200px"}})})})}),t.jsx(S,{spinning:Y,children:t.jsx(f,{rowSelection:Te,dataSource:i,pagination:!1,bordered:!0,style:{marginBottom:"0px",zIndex:2},size:"small",columns:Se,scroll:{y:T},summary:e=>{let l=0,a=0,s=0,b=0,g=0,p=0,n=0,c=0,x=0,o=0,v=0,E=0;e.forEach(({eth_balance:m,scroll_eth_balance:h,scroll_usdc_balance:U,scroll_usdt_balance:M,scroll_tx_amount:V,totalFee:ee,dayActivity:te,weekActivity:le,monthActivity:ne,contractActivity:ke,totalExchangeAmount:Ae,scroll_score:ve})=>{l+=Number(m),a+=Number(h),s+=Number(U),b+=Number(M),g+=Number(ee),p+=Number(V),n+=Number(te),c+=Number(le),x+=Number(ne),o+=Number(ke),v+=Number(Ae),E+=Number(ve)}),p=p/e.length,n=n/e.length,c=c/e.length,x=x/e.length,o=o/e.length,v=v/e.length,E=E/e.length;const L=Array(5).fill().map((m,h)=>t.jsx(f.Summary.Cell,{index:h+11},h));return t.jsx(t.Fragment,{children:t.jsxs(f.Summary.Row,{children:[t.jsx(f.Summary.Cell,{index:0,colSpan:4,children:"总计"}),t.jsx(f.Summary.Cell,{index:4,children:l.toFixed(4)}),t.jsx(f.Summary.Cell,{index:5}),t.jsx(f.Summary.Cell,{index:8,children:a.toFixed(4)}),t.jsx(f.Summary.Cell,{index:9,children:s.toFixed(2)}),t.jsx(f.Summary.Cell,{index:10,children:b.toFixed(2)}),t.jsxs(f.Summary.Cell,{index:11,children:["-",p.toFixed(0),"-"]}),L,t.jsxs(f.Summary.Cell,{index:17,children:["-",n.toFixed(0),"-"]}),t.jsxs(f.Summary.Cell,{index:18,children:["-",c.toFixed(0),"-"]}),t.jsxs(f.Summary.Cell,{index:19,children:["-",x.toFixed(0),"-"]}),t.jsxs(f.Summary.Cell,{index:20,children:["-",o.toFixed(0),"-"]}),t.jsxs(f.Summary.Cell,{index:21,children:["-",v.toFixed(0),"-"]}),t.jsx(f.Summary.Cell,{index:23,children:g.toFixed(4)}),t.jsxs(f.Summary.Cell,{index:24,children:["-",E.toFixed(0),"-"]}),t.jsx(f.Summary.Cell,{index:25})]})})},footer:()=>t.jsx(Ie,{children:t.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",gap:"20px"},children:[t.jsx(z,{type:"primary",onClick:ye,loading:y,size:"large",style:{width:"20%"},icon:t.jsx(Be,{}),children:y?"正在刷新":"刷新选中地址"}),t.jsx(z,{type:"primary",onClick:xe,size:"large",style:{width:"20%"},icon:t.jsx(Ce,{}),loading:A,children:A?`添加中 进度:(${r}/${w})`:"添加地址"}),t.jsx(oe,{title:"确认删除"+F.length+"个地址？",onConfirm:_e,children:t.jsx(z,{type:"primary",danger:!0,size:"large",style:{width:"20%"},icon:t.jsx(ae,{}),children:"删除选中地址"})}),t.jsx(z,{type:"primary",icon:t.jsx(Fe,{}),size:"large",style:{width:"8%"},onClick:pe})]})})})})]})})}export{xt as default};
