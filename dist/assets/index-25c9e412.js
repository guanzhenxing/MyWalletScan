import{r as F,j as s}from"./index-aeda1e87.js";import{U as Nt,D as Ft,e as At}from"./save_excel-2f1f7d40.js";import{a as D,C as Ot}from"./axios-057734f1.js";import{F as W}from"./index-9f5a0d13.js";import{M as ct,P as _t,D as ut}from"./DeleteOutlined-67da6863.js";import{I as ot,E as Gt,a as Jt}from"./Pagination-637f931d.js";import{S as j}from"./index-c463ec7e.js";import{T as A,a as Ut}from"./index-e00a8a8b.js";import{B as V,E as $t}from"./EditOutlined-3f21ada2.js";import{L as Bt}from"./index-06592163.js";import{S as mt,n as R}from"./SyncOutlined-80c16cfc.js";import{S as Pt}from"./index-cd8267bc.js";import{P as zt}from"./PlusOutlined-74a5f9c7.js";import"./useFlexGapSupport-69780201.js";import"./FileSaver.min-b2a08254.js";import"./row-da0b9f45.js";import"./responsiveObserver-953ba023.js";import"./col-bebaa28a.js";import"./index-d904ea6a.js";import"./Sider-20598f97.js";import"./useNotification-4ae4ff01.js";async function Q(m){try{let k=`https://voyager.online/api/txns?to=${m}&ps=50&p=1&type=null`;const f=await D.get(k),w=f.data.lastPage,i=f.data.items[0].timestamp,o=new Date(i*1e3),d=8,c=new Date(o.getTime()+d*3600*1e3),I=new Date,E=new Date(I.getTime()+d*3600*1e3)-c,p=Math.floor(E/(1e3*60*60)),S=Math.floor(p/24);let x="";S>0?x=`${S} 天前`:p>0?x=`${p} 小时前`:x="刚刚";let q=0;for(let X=1;X<=w;X++){const K=`https://voyager.online/api/txns?to=${m}&ps=50&p=${X}&type=null`,st=(await D.get(K)).data.items;q+=st.length}return{tx:q,stark_latest_tx_time:x}}catch(k){return console.error(k),{tx:"Error",stark_latest_tx_time:"Error"}}}async function ht(m,k,f,w){for(let i=0;i<w.length;i++){const o=w[i].node;o.transaction_hash;const d=o.transfer_amount_display,c=o.transfer_from_address,I=o.transfer_to_address;o.timestamp,o.transfer_to_identifier;const b=o.main_call?o.main_call.selector_identifier:null,E=o.from_erc20_identifier;if(c==="0x0000000000000000000000000000000000000000000000000000000000000000"&&b==="handle_deposit"){const p=o.from_erc20_identifier;if(p in k){const S=k[p].amount+=parseFloat(d),x=k[p].count+=1;k[p]={amount:S,count:x}}else k[p]={amount:parseFloat(d),count:1}}else if(I==="0x0000000000000000000000000000000000000000000000000000000000000000"&&E==="StarkGate: ETH"){const p=o.from_erc20_identifier;if(p in f){const S=f[p].amount+=parseFloat(d),x=f[p].count+=1;f[p]={amount:S,count:x}}else f[p]={amount:parseFloat(d),count:1}}}return[k,f]}async function et(m){try{const k="https://starkscan.stellate.sh/",f={authority:"starkscan.stellate.sh",accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json"},w={query:`query ERC20TransferEventsTableQuery(
  $first: Int!
  $after: String
  $input: ERC20TransferEventsInput!
) {
  ...ERC20TransferEventsTablePaginationFragment_erc20TransferEvents_2DAjA4
}

fragment ERC20TransferEventsTablePaginationFragment_erc20TransferEvents_2DAjA4 on Query {
  erc20TransferEvents(first: $first, after: $after, input: $input) {
    edges {
      node {
        id
        ...ERC20TransferEventsTableRowFragment_erc20TransferEvent
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment ERC20TransferEventsTableRowFragment_erc20TransferEvent on ERC20TransferEvent {
  id
  transaction_hash
  from_address
  from_erc20_identifier
  from_contract {
    is_social_verified
    id
  }
  transfer_from_address
  transfer_from_identifier
  transfer_from_contract {
    is_social_verified
    id
  }
  transfer_to_address
  transfer_to_identifier
  transfer_to_contract {
    is_social_verified
    id
  }
  transfer_amount
  transfer_amount_display
  timestamp
  main_call {
    selector_identifier
    id
  }
}
`,variables:{first:30,after:null,input:{transfer_from_or_to_address:m,sort_by:"timestamp",order_by:"desc"}}};let i=await D.post(k,w,{headers:f}),o=i.data.data.erc20TransferEvents.edges,d={},c={},I=i.data.data.erc20TransferEvents.pageInfo.hasNextPage,b;for([d,c]=await ht(m,d,c,o),I&&(b=i.data.data.erc20TransferEvents.pageInfo.endCursor);I===!0;){w.variables.after=b;let S=await D.post(k,w,{headers:f});I=S.data.data.erc20TransferEvents.pageInfo.hasNextPage,I===!1?b=null:b=S.data.data.erc20TransferEvents.pageInfo.endCursor,[d,c]=await ht(m,d,c,S.data.data.erc20TransferEvents.edges)}let E=0,p=0;for(let S in d)E+=d[S].count;for(let S in c)p+=c[S].count;return console.log(d),console.log(c),{d_eth_amount:d["StarkGate: ETH"]?parseFloat(d["StarkGate: ETH"].amount).toFixed(3):0,d_eth_count:d["StarkGate: ETH"]?d["StarkGate: ETH"].count:0,d_usdc_amount:d["StarkGate: USDC"]?parseFloat(d["StarkGate: USDC"].amount).toFixed(3):0,d_usdc_count:d["StarkGate: USDC"]?d["StarkGate: USDC"].count:0,d_usdt_amount:d["StarkGate: USDT"]?parseFloat(d["StarkGate: USDT"].amount).toFixed(3):0,d_usdt_count:d["StarkGate: USDT"]?d["StarkGate: USDT"].count:0,d_dai_amount:d["StarkGate: DAI"]?parseFloat(d["StarkGate: DAI"].amount).toFixed(3):0,d_dai_count:d["StarkGate: DAI"]?d["StarkGate: DAI"].count:0,d_wbtc_amount:d["StarkGate: WBTC"]?parseFloat(d["StarkGate: WBTC"].amount).toFixed(6):0,d_wbtc_count:d["StarkGate: WBTC"]?d["StarkGate: WBTC"].count:0,w_eth_amount:c["StarkGate: ETH"]?parseFloat(c["StarkGate: ETH"].amount).toFixed(3):0,w_eth_count:c["StarkGate: ETH"]?c["StarkGate: ETH"].count:0,w_usdc_amount:c["StarkGate: USDC"]?parseFloat(c["StarkGate: USDC"].amount).toFixed(3):0,w_usdc_count:c["StarkGate: USDC"]?c["StarkGate: USDC"].count:0,w_usdt_amount:c["StarkGate: USDT"]?parseFloat(c["StarkGate: USDT"].amount).toFixed(3):0,w_usdt_count:c["StarkGate: USDT"]?c["StarkGate: USDT"].count:0,w_dai_amount:c["StarkGate: DAI"]?parseFloat(c["StarkGate: DAI"].amount).toFixed(3):0,w_dai_count:c["StarkGate: DAI"]?c["StarkGate: DAI"].count:0,w_wbtc_amount:c["StarkGate: WBTC"]?parseFloat(c["StarkGate: WBTC"].amount).toFixed(6):0,w_wbtc_count:c["StarkGate: WBTC"]?c["StarkGate: WBTC"].count:0,total_deposit_count:E,total_widthdraw_count:p}}catch(k){return console.log(k),{d_eth_amount:"Error",d_eth_count:"Error",d_usdc_amount:"Error",d_usdc_count:"Error",d_usdt_amount:"Error",d_usdt_count:"Error",d_dai_amount:"Error",d_dai_count:"Error",d_wbtc_amount:"Error",d_wbtc_count:"Error",w_eth_amount:"Error",w_eth_count:"Error",w_usdc_amount:"Error",w_usdc_count:"Error",w_usdt_amount:"Error",w_usdt_count:"Error",w_dai_amount:"Error",w_dai_count:"Error",w_wbtc_amount:"Error",w_wbtc_count:"Error",total_deposit_count:"Error",total_widthdraw_count:"Error"}}}async function at(m){var k;try{let f=`https://voyager.online/api/contract/${m}`;const w=await D.get(f),i=w.data.creationTimestamp,o=(k=w.data)==null?void 0:k.classAlias;let d=w.data.contractAlias;return d===null&&(d="/"),{wallet_type:o,deployed_at_timestamp:i,stark_id:d}}catch(f){return console.error(f),{wallet_type:"Error",deployed_at_timestamp:"Error",stark_id:"Error"}}}function Mt(m){return`${m.getUTCFullYear()}-${m.getUTCMonth()+1}-${m.getUTCDate()}`}function Ht(m){m=new Date(Date.UTC(m.getFullYear(),m.getMonth(),m.getDate())),m.setUTCDate(m.getUTCDate()+4-(m.getUTCDay()||7));let k=new Date(Date.UTC(m.getUTCFullYear(),0,1)),f=Math.ceil(((m-k)/864e5+1)/7);return m.getUTCFullYear()+"W"+f}function Rt(m){return m.getUTCFullYear()+"-"+(m.getUTCMonth()+1)}async function nt(m){try{let k,f,w,i=new Set,o=new Set,d=new Set,c=`https://voyager.online/api/txns?to=${m}&ps=50&p=1&type=null`;const I=await D.get(c);let b=I.data.items.map(E=>new Date(E.timestamp*1e3));for(let E=2;E<=I.data.lastPage;E++){const p=`https://voyager.online/api/txns?to=${m}=50&p=${E}&type=null`,x=(await D.get(p)).data.items.map(q=>q.timestamp);b.concat(x)}return b.forEach(E=>{i.add(Mt(E)),o.add(Ht(E)),d.add(Rt(E))}),k=i.size,f=o.size,w=d.size,{dayActivity:k,weekActivity:f,monthActivity:w}}catch(k){return console.error(k),{dayActivity:"Error",weekActivity:"Error",monthActivity:"Error"}}}const Vt=async()=>{try{const m={method:"GET",url:"https://min-api.cryptocompare.com/data/price?fsym=ETH&tsyms=USD"};return(await D.request(m)).data.USD}catch(m){return console.log(m),"/"}};async function rt(m){var k,f;try{const w=await Vt();let i=`https://voyager.online/api/contract/${m}/transfers?ps=50&p=1`;const d=(await D.get(i)).data.lastPage;let c=0;for(let I=1;I<=d;I++){const b=`https://voyager.online/api/contract/${m}/transfers?ps=50&p=${I}`,p=(await D.get(b)).data.items;for(let S=0;S<p.length;S++)if(((k=p[S].transfer_from)==null?void 0:k.toLowerCase())===(m==null?void 0:m.toLowerCase())&&((f=p[S].transfer_to)==null?void 0:f.toLowerCase())!=="0x01176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8"){const x=p[S].token_symbol;x==="ETH"?c+=parseFloat(p[S].transfer_value)*parseFloat(w):x==="USDC"&&(c+=parseFloat(p[S].transfer_value))}}return{stark_exchange_amount:c.toFixed(2)}}catch(w){return console.error(w),{stark_exchange_amount:"Error"}}}async function Y(m){var k,f,w,i,o;try{let d=`https://voyager.online/api/contract/${m}/balances`;const c=await D.get(d),I=((k=c.data.find(x=>x.symbol==="ETH"))==null?void 0:k.formattedBalance)||0,b=((f=c.data.find(x=>x.symbol==="USDC"))==null?void 0:f.formattedBalance)||0,E=((w=c.data.find(x=>x.symbol==="USDT"))==null?void 0:w.formattedBalance)||0,p=((i=c.data.find(x=>x.symbol==="DAI"))==null?void 0:i.formattedBalance)||0,S=((o=c.data.find(x=>x.symbol==="STRK"))==null?void 0:o.formattedBalance)||0;return{eth_balance:parseFloat(I).toFixed(4),usdc_balance:parseFloat(b).toFixed(2),usdt_balance:parseFloat(E).toFixed(2),dai_balance:parseFloat(p).toFixed(2),strk_balance:parseFloat(S).toFixed(1)}}catch(d){return console.error(d),{eth_balance:"Error",usdc_balance:"Error",usdt_balance:"Error",dai_balance:"Error",strk_balance:"Error"}}}async function kt(m){var k,f,w;try{const i=BigInt(m);let o=`https://api.starknet.id/addr_to_full_ids?addr=${i}`,c=(f=(k=(await D.get(o)).data)==null?void 0:k.full_ids[0])==null?void 0:f.domain;return c==null&&(o=`https://api.starknet.id/addr_to_external_domains?addr=${i}`,c=(w=(await D.get(o)).data)==null?void 0:w.domains[0],c==null&&(c="/")),{stark_id:c}}catch(i){return console.error(i),{stark_id:"Error"}}}async function ft(m){var k;try{let f=`https://birdonline.xyz/starknet?address=${m}`,i=(k=(await D.get(f)).data)==null?void 0:k.amount;return(i==null||i==null||i=="")&&(i=0),{airdrop:i}}catch(f){return console.error(f),{airdrop:"Error"}}}const{TextArea:Lt}=ot,{Content:Wt}=Bt,ke=()=>{const[m,k]=F.useState(!1),[f,w]=F.useState(!1),[i,o]=F.useState([]),[d]=W.useForm(),[c,I]=F.useState(!1),[b,E]=F.useState([]),[p,S]=F.useState(!1),[x]=W.useForm(),[q,X]=F.useState(0),[K,it]=F.useState(!1),st=()=>{it(!K)},dt=()=>K?s.jsx(Gt,{}):s.jsx(Jt,{});F.useEffect(()=>{const e=()=>{X(window.innerHeight-260)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),F.useEffect(()=>{S(!0);const e=localStorage.getItem("stark_addresses");setTimeout(()=>{S(!1)},500),e&&o(JSON.parse(e))},[]);const yt=e=>{o(i.filter(l=>l.key!==e)),localStorage.setItem("stark_addresses",JSON.stringify(i.filter(l=>l.key!==e)))},gt=async()=>{try{const e=await x.validateFields();if(e.address.length!==66&&e.address.length!==64){R.error({message:"错误",description:"请输入正确的stark地址(64位)"},2);return}e.address.startsWith("0x")||(e.address="0x"+e.address),k(!1);const l=i.findIndex(a=>a.address===e.address);if(l!==-1){o(i.map((r,_)=>_===l?{...r,name:e.name}:r));const a=[...i];at(e.address).then(({wallet_type:r,deployed_at_timestamp:_,stark_id:n})=>{a[l]={...a[l],wallet_type:r,create_time:_,stark_id:n},o(a),localStorage.setItem("stark_addresses",JSON.stringify(i))}),Y(e.address).then(({eth_balance:r,usdc_balance:_,usdt_balance:n,dai_balance:u})=>{a[l]={...a[l],stark_eth_balance:r,stark_usdc_balance:_,stark_usdt_balance:n,stark_dai_balance:u},o(a),localStorage.setItem("stark_addresses",JSON.stringify(i))}),nt(e.address).then(({dayActivity:r,weekActivity:_,monthActivity:n})=>{a[l]={...a[l],dayActivity:r,weekActivity:_,monthActivity:n},o(a),localStorage.setItem("stark_addresses",JSON.stringify(i))}),rt(e.address).then(({stark_exchange_amount:r})=>{a[l]={...a[l],stark_exchange_amount:r},o(a),localStorage.setItem("stark_addresses",JSON.stringify(i))}),et(e.address).then(({d_eth_amount:r,d_eth_count:_,d_usdc_amount:n,d_usdc_count:u,d_usdt_amount:h,d_usdt_count:g,d_dai_amount:t,d_dai_count:y,d_wbtc_amount:T,d_wbtc_count:v,w_eth_amount:C,w_eth_count:N,w_usdc_amount:O,w_usdc_count:G,w_usdt_amount:J,w_usdt_count:U,w_dai_amount:$,w_dai_count:B,w_wbtc_amount:P,w_wbtc_count:z,total_deposit_count:M,total_widthdraw_count:H})=>{a[l]={...a[l],d_eth_amount:r,d_eth_count:_,d_usdc_amount:n,d_usdc_count:u,d_usdt_amount:h,d_usdt_count:g,d_dai_amount:t,d_dai_count:y,d_wbtc_amount:T,d_wbtc_count:v,w_eth_amount:C,w_eth_count:N,w_usdc_amount:O,w_usdc_count:G,w_usdt_amount:J,w_usdt_count:U,w_dai_amount:$,w_dai_count:B,w_wbtc_amount:P,w_wbtc_count:z,total_deposit_count:M,total_widthdraw_count:H},o(a),localStorage.setItem("stark_addresses",JSON.stringify(i))}),Q(e.address).then(({tx:r,stark_latest_tx_time:_})=>{a[l]={...a[l],stark_tx_amount:r,stark_latest_tx_time:_},o(a),localStorage.setItem("stark_addresses",JSON.stringify(i))})}else{const a={key:i.length.toString(),name:e.name,address:e.address,stark_eth_balance:null,stark_usdc_balance:null,stark_usdt_balance:null,stark_dai_balance:null,dayActivity:null,weekActivity:null,monthActivity:null,stark_exchange_amount:null,stark_id:null,create_time:null,d_eth_amount:null,d_eth_count:null,d_usdc_amount:null,d_usdc_count:null,d_usdt_amount:null,d_usdt_count:null,d_dai_amount:null,d_dai_count:null,d_wbtc_amount:null,d_wbtc_count:null,w_eth_amount:null,w_eth_count:null,w_usdc_amount:null,w_usdc_count:null,w_usdt_amount:null,w_usdt_count:null,w_dai_amount:null,w_dai_count:null,w_wbtc_amount:null,w_wbtc_count:null,stark_tx_amount:null,stark_latest_tx:null,stark_latest_tx_time:null,total_deposit_count:null,total_widthdraw_count:null,stark_airdrop:null},r=[...i,a];o(r),Q(e.address).then(({tx:_,stark_latest_tx_time:n})=>{a.stark_tx_amount=_,a.stark_latest_tx_time=n,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),at(e.address).then(({wallet_type:_,deployed_at_timestamp:n,stark_id:u})=>{a.wallet_type=_,a.create_time=n,a.stark_id=u,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),Y(e.address).then(({eth_balance:_,usdc_balance:n,usdt_balance:u,dai_balance:h})=>{a.stark_eth_balance=_,a.stark_usdc_balance=n,a.stark_usdt_balance=u,a.stark_dai_balance=h,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),nt(e.address).then(({dayActivity:_,weekActivity:n,monthActivity:u})=>{a.dayActivity=_,a.weekActivity=n,a.monthActivity=u,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),rt(e.address).then(({stark_exchange_amount:_})=>{a.stark_exchange_amount=_,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),et(e.address).then(({d_eth_amount:_,d_eth_count:n,d_usdc_amount:u,d_usdc_count:h,d_usdt_amount:g,d_usdt_count:t,d_dai_amount:y,d_dai_count:T,d_wbtc_amount:v,d_wbtc_count:C,w_eth_amount:N,w_eth_count:O,w_usdc_amount:G,w_usdc_count:J,w_usdt_amount:U,w_usdt_count:$,w_dai_amount:B,w_dai_count:P,w_wbtc_amount:z,w_wbtc_count:M,total_widthdraw_count:H,total_deposit_count:L})=>{a.d_eth_amount=_,a.d_eth_count=n,a.d_usdc_amount=u,a.d_usdc_count=h,a.d_usdt_amount=g,a.d_usdt_count=t,a.d_dai_amount=y,a.d_dai_count=T,a.d_wbtc_amount=v,a.d_wbtc_count=C,a.w_eth_amount=N,a.w_eth_count=O,a.w_usdc_amount=G,a.w_usdc_count=J,a.w_usdt_amount=U,a.w_usdt_count=$,a.w_dai_amount=B,a.w_dai_count=P,a.w_wbtc_amount=z,a.w_wbtc_count=M,a.total_deposit_count=L,a.total_widthdraw_count=H,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))})}}catch(e){R.error({message:"错误",description:e.message},2)}finally{x.resetFields()}},pt=async()=>{try{const l=(await d.validateFields()).addresses.split(`
`),a=[...i];for(let r of l){if(r=r.trim(),r.length!==66&&r.length!==64){R.error({message:"错误",description:"请输入正确的stark地址(64位)"});continue}r.startsWith("0x")||(r="0x"+r);const _=a.findIndex(n=>n.address===r);if(_!==-1){const n=[...a];Q(r).then(({tx:u,stark_latest_tx_time:h})=>{n[_]={...n[_],stark_tx_amount:u,stark_latest_tx_time:h},o(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),at(r).then(({wallet_type:u,deployed_at_timestamp:h,stark_id:g})=>{n[_]={...n[_],wallet_type:u,create_time:h,stark_id:g},o(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),Y(r).then(({eth_balance:u,usdc_balance:h,usdt_balance:g,dai_balance:t})=>{n[_]={...n[_],stark_eth_balance:u,stark_usdc_balance:h,stark_usdt_balance:g,stark_dai_balance:t},o(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),nt(r).then(({dayActivity:u,weekActivity:h,monthActivity:g})=>{n[_]={...n[_],dayActivity:u,weekActivity:h,monthActivity:g},o(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),rt(r).then(({stark_exchange_amount:u})=>{n[_]={...n[_],stark_exchange_amount:u},o(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),et(r).then(({d_eth_amount:u,d_eth_count:h,d_usdc_amount:g,d_usdc_count:t,d_usdt_amount:y,d_usdt_count:T,d_dai_amount:v,d_dai_count:C,d_wbtc_amount:N,d_wbtc_count:O,w_eth_amount:G,w_eth_count:J,w_usdc_amount:U,w_usdc_count:$,w_usdt_amount:B,w_usdt_count:P,w_dai_amount:z,w_dai_count:M,w_wbtc_amount:H,w_wbtc_count:L,total_widthdraw_count:Z,total_deposit_count:tt})=>{n[_]={...n[_],d_eth_amount:u,d_eth_count:h,d_usdc_amount:g,d_usdc_count:t,d_usdt_amount:y,d_usdt_count:T,d_dai_amount:v,d_dai_count:C,d_wbtc_amount:N,d_wbtc_count:O,w_eth_amount:G,w_eth_count:J,w_usdc_amount:U,w_usdc_count:$,w_usdt_amount:B,w_usdt_count:P,w_dai_amount:z,w_dai_count:M,w_wbtc_amount:H,w_wbtc_count:L,total_widthdraw_count:Z,total_deposit_count:tt}}),await new Promise(u=>setTimeout(u,2e3))}else{const n={key:a.length.toString(),address:r,stark_eth_balance:null,stark_usdc_balance:null,stark_usdt_balance:null,stark_dai_balance:null,dayActivity:null,weekActivity:null,monthActivity:null,stark_exchange_amount:null,stark_id:null,create_time:null,d_eth_amount:null,d_eth_count:null,d_usdc_amount:null,d_usdc_count:null,d_usdt_amount:null,d_usdt_count:null,d_dai_amount:null,d_dai_count:null,d_wbtc_amount:null,d_wbtc_count:null,w_eth_amount:null,w_eth_count:null,w_usdc_amount:null,w_usdc_count:null,w_usdt_amount:null,w_usdt_count:null,w_dai_amount:null,w_dai_count:null,w_wbtc_amount:null,w_wbtc_count:null,stark_tx_amount:null,stark_latest_tx:null,stark_latest_tx_time:null,total_deposit_count:null,total_widthdraw_count:null,stark_airdrop:null};a.push(n),o(a),Q(r).then(({tx:u,stark_latest_tx_time:h})=>{n.stark_tx_amount=u,n.stark_latest_tx_time=h,o([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),at(r).then(({wallet_type:u,deployed_at_timestamp:h,stark_id:g})=>{n.wallet_type=u,n.create_time=h,n.stark_id=g,o([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),Y(r).then(({eth_balance:u,usdc_balance:h,usdt_balance:g,dai_balance:t})=>{n.stark_eth_balance=u,n.stark_usdc_balance=h,n.stark_usdt_balance=g,n.stark_dai_balance=t,o([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),nt(r).then(({dayActivity:u,weekActivity:h,monthActivity:g})=>{n.dayActivity=u,n.weekActivity=h,n.monthActivity=g,o([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),rt(r).then(({stark_exchange_amount:u})=>{n.stark_exchange_amount=u,o([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),et(r).then(({d_eth_amount:u,d_eth_count:h,d_usdc_amount:g,d_usdc_count:t,d_usdt_amount:y,d_usdt_count:T,d_dai_amount:v,d_dai_count:C,d_wbtc_amount:N,d_wbtc_count:O,w_eth_amount:G,w_eth_count:J,w_usdc_amount:U,w_usdc_count:$,w_usdt_amount:B,w_usdt_count:P,w_dai_amount:z,w_dai_count:M,w_wbtc_amount:H,w_wbtc_count:L,total_widthdraw_count:Z,total_deposit_count:tt})=>{n.d_eth_amount=u,n.d_eth_count=h,n.d_usdc_amount=g,n.d_usdc_count=t,n.d_usdt_amount=y,n.d_usdt_count=T,n.d_dai_amount=v,n.d_dai_count=C,n.d_wbtc_amount=N,n.d_wbtc_count=O,n.w_eth_amount=G,n.w_eth_count=J,n.w_usdc_amount=U,n.w_usdc_count=$,n.w_usdt_amount=B,n.w_usdt_count=P,n.w_dai_amount=z,n.w_dai_count=M,n.w_wbtc_amount=H,n.w_wbtc_count=L,n.total_widthdraw_count=Z,n.total_deposit_count=tt,o([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),await new Promise(u=>setTimeout(u,2e3))}}w(!1)}catch(e){R.error({message:"错误",description:e.message})}finally{d.resetFields(),E([])}},wt=async()=>{if(!b.length){R.error({message:"错误",description:"请先选择要刷新的地址"},2);return}I(!0);try{let l=0,a=[];const r=[...i];let _=[];const n=()=>{for(;l<20&&a.length>0;){const h=a.shift();l+=1,h().finally(()=>{l-=1,n()})}};for(let h of b){const g=r.findIndex(t=>t.key===h);if(g!==-1){const t=r[g];t.stark_tx_amount=null,t.stark_latest_tx=null,t.stark_latest_tx_time=null,t.stark_eth_balance=null,t.stark_usdc_balance=null,t.stark_usdt_balance=null,t.stark_dai_balance=null,t.stark_strk_balance=null,t.d_eth_amount=null,t.d_eth_count=null,t.d_usdc_amount=null,t.d_usdc_count=null,t.d_usdt_amount=null,t.d_usdt_count=null,t.d_dai_amount=null,t.d_dai_count=null,t.d_wbtc_amount=null,t.d_wbtc_count=null,t.w_eth_amount=null,t.w_eth_count=null,t.w_usdc_amount=null,t.w_usdc_count=null,t.w_usdt_amount=null,t.w_usdt_count=null,t.w_dai_amount=null,t.w_dai_count=null,t.w_wbtc_amount=null,t.w_wbtc_count=null,t.total_widthdraw_count=null,t.total_deposit_count=null,t.stark_airdrop=null,o([...r]),a.push(()=>Q(t.address).then(({tx:y,stark_latest_tx_time:T,stark_timestamps:v})=>{t.stark_tx_amount=y,t.stark_latest_tx_time=T,_.push(v),o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(i))})),a.push(()=>ft(t.address).then(({airdrop:y})=>{t.stark_airdrop=y,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))})),a.push(()=>Y(t.address).then(({eth_balance:y,usdc_balance:T,usdt_balance:v,dai_balance:C,strk_balance:N})=>{t.stark_eth_balance=y,t.stark_usdc_balance=T,t.stark_usdt_balance=v,t.stark_dai_balance=C,t.stark_strk_balance=N,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(i))})),a.push(()=>et(t.address).then(({d_eth_amount:y,d_eth_count:T,d_usdc_amount:v,d_usdc_count:C,d_usdt_amount:N,d_usdt_count:O,d_dai_amount:G,d_dai_count:J,d_wbtc_amount:U,d_wbtc_count:$,w_eth_amount:B,w_eth_count:P,w_usdc_amount:z,w_usdc_count:M,w_usdt_amount:H,w_usdt_count:L,w_dai_amount:Z,w_dai_count:tt,w_wbtc_amount:vt,w_wbtc_count:jt,total_widthdraw_count:Ct,total_deposit_count:Dt})=>{t.d_eth_amount=y,t.d_eth_count=T,t.d_usdc_amount=v,t.d_usdc_count=C,t.d_usdt_amount=N,t.d_usdt_count=O,t.d_dai_amount=G,t.d_dai_count=J,t.d_wbtc_amount=U,t.d_wbtc_count=$,t.w_eth_amount=B,t.w_eth_count=P,t.w_usdc_amount=z,t.w_usdc_count=M,t.w_usdt_amount=H,t.w_usdt_count=L,t.w_dai_amount=Z,t.w_dai_count=tt,t.w_wbtc_amount=vt,t.w_wbtc_count=jt,t.total_widthdraw_count=Ct,t.total_deposit_count=Dt,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(i))}))}n()}for(;l>0||a.length>0;)await new Promise(h=>setTimeout(h,2e3));const u=_.flat();localStorage.setItem("stark_timestamps",JSON.stringify(u));for(let h of b){const g=r.findIndex(t=>t.key===h);if(g!==-1){const t=r[g];t.dayActivity=null,t.weekActivity=null,t.monthActivity=null,t.stark_exchange_amount=null,(t.wallet_type==="Error"||t.wallet_type===void 0)&&at(t.address).then(({wallet_type:y,deployed_at_timestamp:T,stark_id:v})=>{t.wallet_type=y,t.create_time=T,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),kt(t.address).then(({stark_id:y})=>{t.stark_id=y,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),nt(t.address).then(({dayActivity:y,weekActivity:T,monthActivity:v})=>{t.dayActivity=y,t.weekActivity=T,t.monthActivity=v,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),rt(t.address).then(({stark_exchange_amount:y})=>{t.stark_exchange_amount=y,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))}),await new Promise(y=>setTimeout(y,5e3))}}}catch(e){R.error({message:"错误",description:e.message},2)}finally{I(!1),E([])}},St=async()=>{if(!b.length){R.error({message:"错误",description:"请先选择要刷新的地址"},2);return}I(!0);try{let l=0,a=[];const r=[...i];let _=[];const n=()=>{for(;l<20&&a.length>0;){const h=a.shift();l+=1,h().finally(()=>{l-=1,n()})}};for(let h of b){const g=r.findIndex(t=>t.key===h);if(g!==-1){const t=r[g];t.stark_tx_amount=null,t.stark_latest_tx_time=null,t.stark_eth_balance=null,t.stark_usdc_balance=null,t.stark_usdt_balance=null,t.stark_dai_balance=null,t.stark_strk_balance=null,o([...r]),a.push(()=>kt(t.address).then(({stark_id:y})=>{t.stark_id=y,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))})),a.push(()=>ft(t.address).then(({airdrop:y})=>{t.stark_airdrop=y,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(r))})),a.push(()=>Q(t.address).then(({tx:y,stark_latest_tx_time:T,stark_timestamps:v})=>{t.stark_tx_amount=y,t.stark_latest_tx_time=T,_.push(v),o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(i))})),a.push(()=>Y(t.address).then(({eth_balance:y,usdc_balance:T,usdt_balance:v,dai_balance:C,strk_balance:N})=>{t.stark_eth_balance=y,t.stark_usdc_balance=T,t.stark_usdt_balance=v,t.stark_dai_balance=C,t.stark_strk_balance=N,o([...r]),localStorage.setItem("stark_addresses",JSON.stringify(i))}))}n()}for(;l>0||a.length>0;)await new Promise(h=>setTimeout(h,2e3));const u=_.flat();localStorage.setItem("stark_timestamps",JSON.stringify(u))}catch(e){R.error({message:"错误",description:e.message},2)}finally{I(!1),E([])}},xt=()=>{if(!b.length){R.error({message:"错误",description:"请先选择要删除的地址"},2);return}o(i.filter(e=>!b.includes(e.key))),localStorage.setItem("stark_addresses",JSON.stringify(i.filter(e=>!b.includes(e.key)))),E([])},bt=()=>{At(i,"starkInfo")},[Et,lt]=F.useState(null),It=[{title:"#",key:"index",align:"center",render:(e,l,a)=>a+1,width:60},{title:"备注",dataIndex:"name",key:"name",align:"center",className:"name",render:(e,l)=>l.key===Et?s.jsx(ot,{placeholder:"请输入备注",defaultValue:e,onPressEnter:r=>{l.name=r.target.value,o([...i]),localStorage.setItem("stark_addresses",JSON.stringify(i)),lt(null)}}):s.jsxs(s.Fragment,{children:[s.jsx(Ut,{color:"blue",onClick:()=>lt(l.key),children:e}),!e&&s.jsx(V,{shape:"circle",icon:s.jsx($t,{}),size:"small",onClick:()=>lt(l.key)})]}),width:100},{title:s.jsxs("span",{children:["钱包地址",s.jsx("span",{onClick:st,style:{marginLeft:8,cursor:"pointer"},children:dt()})]}),dataIndex:"address",key:"address",align:"center",className:"address",render:(e,l)=>K?"***":e===null?s.jsx(j,{}):e.slice(0,6)+"..."+e.slice(-6),width:140},{title:s.jsxs("span",{children:["starkId",s.jsx("span",{onClick:st,style:{marginLeft:8,cursor:"pointer"},children:dt()})]}),dataIndex:"stark_id",key:"stark_id",align:"center",className:"stark_id",render:(e,l)=>K?"***":e===null?s.jsx(j,{}):e,width:100},{title:"创建时间",dataIndex:"create_time",key:"create_time",align:"center",className:"create_time",render:(e,l)=>{if(e===null)return s.jsx(j,{});{let a=new Date(e*1e3),r=a.getFullYear(),_=(a.getMonth()+1).toString().padStart(2,"0"),n=a.getDate().toString().padStart(2,"0");return`${r}/${_}/${n}`}},width:100},{title:"钱包类型",dataIndex:"wallet_type",key:"wallet_type",align:"center",className:"wallet_type",render:(e,l)=>e===null?s.jsx(j,{}):e===void 0||e==="Error"?"/":e==null?void 0:e.slice(0,-5),width:80},{title:"StarkNet",className:"starkNet",children:[{title:"ETH",dataIndex:"stark_eth_balance",key:"stark_eth_balance",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:70},{title:"USDC",dataIndex:"stark_usdc_balance",key:"stark_usdc_balance",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:70},{title:"USDT",dataIndex:"stark_usdt_balance",key:"stark_usdt_balance",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:70},{title:"DAI",dataIndex:"stark_dai_balance",key:"stark_dai_balance",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:70},{title:"STRK",dataIndex:"stark_strk_balance",key:"stark_strk_balance",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:70},{title:"Tx",dataIndex:"stark_tx_amount",key:"stark_tx_amount",align:"center",sorter:(e,l)=>e.stark_tx_amount-l.stark_tx_amount,render:(e,l)=>{if(e===null)return s.jsx(j,{});const a=Math.log(e),r=Math.log(1),_=Math.log(100),n=(a-r)/(_-r),u=.1,t=`rgba(173, 216, 230, ${n*(1-u)+u})`;return{children:e,props:{style:{background:t}}}},width:70},{title:"最后交易",dataIndex:"stark_latest_tx_time",key:"stark_latest_tx_time",align:"center",render:(e,l)=>{let a="inherit";return e===null?s.jsx(j,{}):(e!=null&&e.includes("天")&&parseInt(e)>7?a="red":a="#1677ff",s.jsx("a",{href:"https://starkscan.co/contract/"+l.address,target:"_blank",style:{color:a},children:e}))},width:70},{title:"活跃统计",key:"activity_stats_group",children:[{title:"日",dataIndex:"dayActivity",key:"dayActivity",align:"center",sorter:(e,l)=>e.dayActivity-l.dayActivity,render:(e,l)=>e===null?s.jsx(j,{}):e,width:60},{title:"周",dataIndex:"weekActivity",key:"weekActivity",align:"center",sorter:(e,l)=>e.weekActivity-l.weekActivity,render:(e,l)=>e===null?s.jsx(j,{}):e,width:60},{title:"月",dataIndex:"monthActivity",key:"monthActivity",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:60},{title:"交易金额(不准)",dataIndex:"stark_exchange_amount",key:"stark_exchange_amount",align:"center",sorter:(e,l)=>e.stark_exchange_amount-l.stark_exchange_amount,render:(e,l)=>{if(e===null)return s.jsx(j,{});const a=Math.log(e),r=Math.log(1),_=Math.log(100),n=(a-r)/(_-r),u=.1,t=`rgba(211, 211, 211, ${n*(1-u)+u})`;return{children:e,props:{style:{background:t}}}},width:100}]},{title:"空投数量",key:"stark_airdrop",dataIndex:"stark_airdrop",align:"center",render:(e,l)=>e===null?s.jsx(j,{}):e,width:100},{title:"操作",key:"action",align:"center",render:(e,l)=>s.jsx(Pt,{size:"small",children:s.jsx(_t,{title:"确认删除？",onConfirm:()=>yt(l.key),children:s.jsx(V,{icon:s.jsx(ut,{})})})}),width:60}]}],Tt={selectedRowKeys:b,onChange:e=>{E(e)}};return s.jsx("div",{children:s.jsxs(Wt,{children:[s.jsx(ct,{title:"批量添加地址",open:f,onOk:pt,onCancel:()=>{w(!1),d.resetFields()},okText:"添加地址",cancelText:"取消",children:s.jsx(W,{form:d,layout:"vertical",children:s.jsx(W.Item,{label:"地址",name:"addresses",rules:[{required:!0}],children:s.jsx(Lt,{placeholder:"请输入地址，每行一个",style:{width:"500px",height:"200px"}})})})}),s.jsx(ct,{title:"添加地址",open:m,onOk:gt,onCancel:()=>k(!1),okText:"添加地址",cancelText:"取消",children:s.jsxs(W,{form:x,layout:"vertical",children:[s.jsx(W.Item,{label:"地址",name:"address",rules:[{required:!0}],children:s.jsx(ot,{placeholder:"请输入地址"})}),s.jsx(W.Item,{label:"备注",name:"name",children:s.jsx(ot,{placeholder:"请输入备注"})})]})}),s.jsxs(j,{spinning:p,children:[s.jsx("div",{style:{width:"100%",margin:"0 auto"},children:s.jsxs("span",{className:"highlight-text",children:["恭喜各位！StarkNet现已空投，本页面将在七天内下线或移动 ",s.jsx("br",{}),"如果这款工具对您有所帮助，并为您带来了额外的价值，那么您的支持将是我们最大的动力。维护和改进这个工具需要不少的时间和精力，您的捐赠将有助于确保我们能够持续提供更好的服务和功能。",s.jsx("br",{}),"点击",s.jsx("a",{href:"https://airdrop.dddd8.xyz/#/donate",children:"这里"}),"对本项目进行捐赠 / 对项目原作者",s.jsx("a",{href:"https://bitboxtools.github.io/#/coffee",children:"捐赠"}),"。再次感谢您的支持，祝您使用愉快！  "]})}),s.jsx(A,{className:"grayed-out",rowSelection:Tt,dataSource:i,pagination:!1,bordered:!0,style:{marginBottom:"0px"},size:"small",columns:It,scroll:{y:q},summary:e=>{let l=0,a=0,r=0,_=0,n=0,u=0;e.forEach(({stark_eth_balance:g,stark_usdc_balance:t,stark_usdt_balance:y,stark_dai_balance:T,stark_strk_balance:v,stark_airdrop:C})=>{l+=Number(g),a+=Number(t),r+=Number(y),_+=Number(T),n+=Number(v),u+=Number(C)});const h=Array(6).fill().map((g,t)=>s.jsx(A.Summary.Cell,{index:t+10},t));return s.jsx(s.Fragment,{children:s.jsxs(A.Summary.Row,{children:[s.jsx(A.Summary.Cell,{index:0,colSpan:7,children:"总计"}),s.jsx(A.Summary.Cell,{index:6,children:l.toFixed(4)}),s.jsx(A.Summary.Cell,{index:7,children:a.toFixed(2)}),s.jsx(A.Summary.Cell,{index:8,children:r.toFixed(2)}),s.jsx(A.Summary.Cell,{index:9,children:_.toFixed(2)}),s.jsx(A.Summary.Cell,{index:10,children:n.toFixed(1)}),h,s.jsx(A.Summary.Cell,{index:11,children:u.toFixed(0)})]})})},footer:()=>s.jsx(Ot,{children:s.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"},children:[s.jsx(V,{type:"primary",onClick:St,loading:c,size:"large",style:{width:"16%"},icon:s.jsx(mt,{}),children:"快速刷新选中地址"}),s.jsx(V,{type:"primary",onClick:wt,loading:c,size:"large",style:{width:"16%"},icon:s.jsx(mt,{}),children:"刷新选中地址（慢）"}),s.jsx(V,{type:"primary",onClick:()=>{k(!0)},size:"large",style:{width:"16%"},icon:s.jsx(zt,{}),children:"添加地址"}),s.jsx(V,{type:"primary",onClick:()=>{w(!0)},size:"large",style:{width:"16%"},icon:s.jsx(Nt,{}),children:"批量添加地址"}),s.jsx(_t,{title:"确认删除"+b.length+"个地址？",onConfirm:xt,children:s.jsx(V,{type:"primary",danger:!0,size:"large",style:{width:"16%"},icon:s.jsx(ut,{}),children:"删除选中地址"})}),s.jsx(V,{type:"primary",icon:s.jsx(Ft,{}),size:"large",style:{width:"8%"},onClick:bt})]})})})]})]})})};export{ke as default};
